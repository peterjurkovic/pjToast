"use strict";angular.module("pjToast.directives",["pjToast.factories"]).directive("toast",["Toast","$log","$window","$timeout",function(a,b,c,d){return{restrict:"EA",replace:!0,template:'<div class="{{config.wrappClassName}}" ng-show="message" ><toast-message message="message"></toast-message></div>',link:function(b,e){b.config=a.config();var f=function(a){function b(){return Math.max(0,c.scrollY+c.innerHeight-2*a[0].offsetHeight)}function d(){return Math.max(0,(c.innerWidth-a[0].offsetWidth)/2+c.scrollX)}a.css("z-index","999").css("position","absolute").css("top",b()+"px").css("left",d()+"px")};b.resize=function(){d(function(){f(e)},0)},b.resize();var g=function(){b.message=a.getActiveMessage(),b.resize()};a.registerCallback(g),b.$on("$destroy",function(){a.unregisterCallback()}),b.config.centerOnScroll&&angular.element(c).bind("scroll",function(){b.message&&b.resize()})}}}]).directive("toastMessage",["$timeout","Toast",function(a,b){return{restrict:"EA",scope:{message:"="},template:'<div ng-click="dismiss()" class="alert alert-{{message.msgClassName}}"><span ng-if="message.withIcon" class="glyphicon glyphicon-{{message.icoClass()}}"></span>{{message.content}}<button type="button" class="close" ng-if="message.dismissOnClick" ng-bind-html="message.dismissButtonHtml"></button></div>',link:function(c){var d=!1;c.$watch("message",function(){c.message.dismissOnTimeout&&(d=a(function(){c.message=b.dismiss()},c.message.timeout))}),c.dismiss=function(){c.message&&c.message.dismissOnClick&&(d&&a.cancel(d),c.message=b.dismiss())}}}}]),angular.module("pjToast.factories",[]).factory("Toast",["$log",function(a){function b(a,b){"string"==typeof a?a={content:a,msgClassName:b}:angular.isDefined(a.msgClassName)||(a.msgClassName=b);var g=new c(a);d?e.push(g):d=g,f&&f()}function c(a){this.msgClassName=g.msgClassName,this.dismissOnTimeout=g.dismissOnTimeout,this.timeout=g.timeout,this.dismissButton=g.dismissButton,this.dismissButtonHtml=g.dismissButtonHtml,this.dismissOnClick=g.dismissOnClick,this.withIcon=g.withIcon,this.icoClass=function(){switch(this.msgClassName){case"success":return"ok";case"info":return"info-sign";case"warning":return"alert";case"danger":return"remove"}return""},angular.extend(this,a)}var d=!1,e=[],f=null,g={wrappClassName:"pj-toast",msgClassName:"",dismissOnTimeout:!0,timeout:4e3,dismissButton:!0,dismissButtonHtml:"&times;",dismissOnClick:!0,centerOnScroll:!0,withIcon:!0},h=function(b){angular.isFunction(b)?(f=b)():a.warn("Toast callback is not a function.")},i=function(){f=null},j=function(){return d},k=function(){return d&&(e.length?(d=e[0],e.splice(0,1)):d=!1),d},l=function(a){b(a,"success")},m=function(a){b(a,"info")},n=function(a){b(a,"warning")},o=function(a){b(a,"danger")},p=function(a){return a?void angular.extend(g,a):g};return{success:l,info:m,warning:n,danger:o,dismiss:k,config:p,getActiveMessage:j,registerCallback:h,unregisterCallback:i}}]),angular.module("pjToast",["ngSanitize","pjToast.directives","pjToast.factories"]);